# ==============================================================================
# Caligo Exploration Suite Configuration
# QIA Challenge 2025 - Default Configuration
# ==============================================================================
#
# This configuration defines the parameters for the automated exploration
# of the QKD security cliff in the 9-dimensional parameter space.
#
# Usage:
#   python main_explor.py --config explor_configs/qia_challenge_config.yaml
#
# ==============================================================================

# ------------------------------------------------------------------------------
# Output Configuration
# ------------------------------------------------------------------------------
output:
  # Base directory for all exploration results
  base_dir: "exploration_results"
  
  # Campaign name (used for result subdirectory)
  campaign_name: "qia_challenge_2025"
  
  # Create timestamped subdirectory
  timestamped: true

# ------------------------------------------------------------------------------
# Phase 1: Latin Hypercube Sampling (LHS) Warmup
# ------------------------------------------------------------------------------
phase1:
  # Total number of LHS samples to generate
  num_samples: 500
  
  # Batch size for parallel execution
  batch_size: 1
  
  # Checkpoint save interval (in batches)
  checkpoint_interval: 5
  
  # Strategy ratio: fraction of BLIND samples (0.5 = balanced)
  strategy_ratio: 0.5

# ------------------------------------------------------------------------------
# Phase 2: Surrogate Model Training
# ------------------------------------------------------------------------------
phase2:
  # Gaussian Process configuration
  gp:
    # Kernel type: rbf, matern32, matern52
    kernel_type: "matern52"
    
    # Number of optimizer restarts for hyperparameter tuning
    n_restarts_optimizer: 10
    
    # Normalize targets before fitting
    normalize_y: true
  
  # Training/validation split
  validation_split: 0.2
  
  # Cross-validation settings (optional)
  cross_validation:
    enabled: false
    n_folds: 5

# ------------------------------------------------------------------------------
# Phase 3: Bayesian Optimization (Active Learning)
# ------------------------------------------------------------------------------
phase3:
  # Number of optimization iterations
  num_iterations: 100
  
  # Batch size per iteration
  batch_size: 1
  
  # Retrain surrogate every N iterations
  retrain_interval: 5
  
  # Checkpoint save interval (in iterations)
  checkpoint_interval: 5
  
  # Acquisition function configuration
  acquisition:
    # Type: straddle (cliff detection), ei (expected improvement), ucb
    type: "straddle"
    
    # Exploration-exploitation parameter (κ for UCB, ξ for EI)
    kappa: 1.96
    
    # Straddle-specific: target efficiency threshold
    target_threshold: 0.0

# ------------------------------------------------------------------------------
# Parameter Space Bounds
# ------------------------------------------------------------------------------
bounds:
  # Storage noise (depolarizing parameter) r ∈ [0.6, 0.95]
  storage_noise_r:
    min: 0.60
    max: 0.95
  
  # Storage rate ν ∈ [0.25, 1.0] (log-uniform sampling)
  storage_rate_nu:
    min: 0.25
    max: 1.0
  
  # Wait time Δt ∈ [10^9, 10^10] ns (log-uniform sampling)  (1–10 s)
  wait_time_ns:
    min_log: 9.0   # 10^9 = 1 s
    max_log: 10.0  # 10^10 = 10 s
  
  # Channel fidelity F ∈ [0.95, 0.995] (beta distribution sampling)
  channel_fidelity:
    min: 0.950
    max: 0.995
  
  # Detection efficiency η ∈ [0.3, 0.95] (log-uniform)
  detection_efficiency:
    min_log: -0.52  # ≈ 0.30
    max_log: -0.02  # ≈ 0.95
  
  # Detector error e_det ∈ [0.001, 0.02]
  detector_error:
    min: 0.001
    max: 0.020
  
  # Dark count probability P_dark ∈ [10^-8, 10^-6] (log-uniform)
  dark_count_prob:
    min_log: -8.0  # 10^-8
    max_log: -6.0  # 10^-6
  
  # Number of EPR pairs N ∈ [10^6, 10^8] (log-uniform)
  num_pairs:
    min_log: 6.0   # 1,000,000
    max_log: 8.0   # 100,000,000

# ------------------------------------------------------------------------------
# Execution Configuration
# ------------------------------------------------------------------------------
execution:
  # Number of parallel workers (default: 16)
  num_workers: 8
  
  # Random seed for reproducibility (null for random)
  random_seed: 42
  
  # Protocol execution timeout (seconds)
  timeout_seconds: 300.0
  
  # Logging level: DEBUG, INFO, WARNING, ERROR
  log_level: "INFO"

# ------------------------------------------------------------------------------
# Visualization Configuration
# ------------------------------------------------------------------------------
visualization:
  # Generate all visualizations after exploration
  enabled: true
  
  # Output format: png, pdf, svg
  format: "png"
  
  # DPI for raster formats
  dpi: 150
  
  # Figure style: seaborn, ggplot, default
  style: "seaborn-v0_8-whitegrid"
  
  # Color maps
  colormaps:
    efficiency: "viridis"
    divergence: "RdBu"
    sensitivity: "plasma"

# ------------------------------------------------------------------------------
# Table Generation Configuration
# ------------------------------------------------------------------------------
tables:
  # Generate result tables after exploration
  enabled: true
  
  # Output formats: csv, latex, markdown
  formats:
    - "csv"
    - "markdown"
  
  # QBER levels for Death Valley table
  qber_levels:
    - 0.01
    - 0.03
    - 0.05
    - 0.08
    - 0.10
    - 0.12
    - 0.14
    - 0.16
    - 0.18
  
  # Storage noise levels for Zone of Feasibility table
  storage_noise_levels:
    - 0.95  # Strong adversary
    - 0.90 
    - 0.85
    - 0.80
    - 0.75
    - 0.70 
    - 0.65 
    - 0.60 
    - 0.55  
    - 0.50  # Weak adversary
